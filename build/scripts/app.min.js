/*!dev-design-in v0.0.3 | Tuesday, March 3rd, 2015, 2:10:28 AM | 2015 Andrzej Dubiel*/var app=angular.module("app",["ui.router","ngResize"]);app.config(["$stateProvider","$urlRouterProvider","$locationProvider","resizeProvider",function(a,b,c,d){b.otherwise("/"),a.state("root",{url:"/:slug?",templateUrl:"views/grid.html",controller:"MainCtrl",resolve:{collectionData:function(a){return a.getData()}}}).state("search",{url:"/search",templateUrl:"views/grid.html",controller:"NavCtrl"}),c.html5Mode(!0),d.throttle=500,d.initBind=!0}]),app.controller("MainCtrl",["$rootScope","$scope","$state","$filter","collectionData",function(a,b,c,d,e){b.init=function(){$("body").removeClass("nav-opened"),a.collection=e,a.categories=d("orderBy")(a.collection.categories,"+order"),a.current=c.params.slug,a.limitAll=20;var b=d("filter")(a.collection.categories,{slug:a.current},!0);b.length>0?(a.currentTag="all",a.tags=b[0].tags,""===a.current?(a.items=a.collection.items,a.limit=a.limitAll):(a.items=d("filter")(a.collection.items,{categories:{slug:a.current}},!0),a.limit=a.items.length)):c.transitionTo("root",{slug:""})},b.init()}]),app.controller("NavCtrl",["$scope","$rootScope","$filter","$state",function(a,b,c,d){a.filterData=function(){b.currentTag=this.tag.slug,b.items=""===b.current?c("filter")(b.collection.items,{tags:{slug:this.tag.slug}},!0):c("filter")(b.collection.items,{categories:{slug:b.current},tags:{slug:this.tag.slug}},!0)},a.showAll=function(){b.currentTag="all",a.resetSearch(),""===b.current?(b.limit=b.limitAll,b.items=b.collection.items):(b.items=c("filter")(b.collection.items,{categories:{slug:b.current}},!0),b.limit=b.items.length)},a.mobileNav=function(){$("body").toggleClass("nav-opened")},a.resetSearch=function(){a.search=void 0},a.modal=function(){$(".about").toggleClass("modal-opened")},a.$watch("search",function(e){if(e)if(d.transitionTo("search"),e.length>=3){var f=c("filter")(b.collection.items,{keywords:e},!1);f.length>0?(b.items=f,b.limit=f.length,a.resultCount=f.length):(b.items=[],a.resultCount=0)}else a.resultCount=0,b.items=[];else a.resultCount=0,d.transitionTo("root",{slug:b.current})})}]),app.directive("resizeLayout",["resize",function(){return{link:function(a,b){a.$on("resize",function(){var a=$(".header").outerHeight(!0),c=$(window).height();b[0].style.height=c-a+"px"})}}}]),app.service("dataService",["$http","myCache",function(a,b){var c=a.get("../data/collection.json").then(function(a){return a.data});this.getData=function(){var a=b.get("myData");return a?a:(b.put("myData",c),c)}}]),app.factory("myCache",["$cacheFactory",function(a){return a("myData")}]),app.directive("isotopeGrid",["$timeout","$rootScope",function(a,b){return{scope:{items:"=isotopeGrid"},link:function(c,d){var e={itemSelector:".cell",isotope:{columnWidth:".grid-sizer"},sortAscending:!0,containerStyle:{position:"relative"}};$(d).isotope(e),b.$watch("items",function(){a(function(){$(d).isotope("reloadItems").isotope({sortBy:"original-order"})})},!0)}}}]);